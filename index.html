<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Следующая станция</title>
  <link rel="stylesheet" href="style.css" />
</head>
<div id="photo-modal" class="hidden">
  <div class="modal-overlay"></div>
  <img id="modal-img">
</div>
<body>

<header id="topbar">
  <div class="topbar-inner">
    <h1 id="map-title">Следующая станция</h1>
    <p class="subtitle">
      Соберите свои воспоминания на карте московского метро —
      места, люди, события, которые были важны именно вам.
    </p>
    <input
      id="map-name-input"
      type="text"
      placeholder="Название вашей карты"
    />
  </div>
</header>
<div id="start-screen">
  <div class="start-box">
    <h1>Следующая станция</h1>
    <p>Соберите свои воспоминания на карте метро</p>

    <button id="create-mode">Создать карту</button>
    <button id="view-mode">Открыть по коду</button>
  </div>
</div>
<div id="app">

  <aside id="sidebar">
    <h2>Станция</h2>
    <div id="station-info">Кликните на станцию</div>

    <textarea id="note" rows="4" placeholder="Заметка…"></textarea>

    <!-- Фото превью -->
    <img
      id="photo-preview"
      style="display:none; max-width:100%; margin-top:10px; border-radius:8px;"
    />

    <input type="file" id="photo" accept="image/*">

    <button id="save">Сохранить</button>
    <button id="reset">Сбросить всё</button>

    <hr>

    <h3>Поделиться картой</h3>
    <button id="share">Создать код</button>
    <div id="share-result"></div>

    <hr>

    <h3>Открыть карту по коду</h3>

    <input
      id="map-code-input"
      type="text"
      placeholder="Код карты"
    />

    <input
      id="access-code-input"
      type="password"
      placeholder="Приватный код"
    />

    <button id="load-map">Открыть</button>
    <div id="load-result"></div>

  </aside>

  <main id="map-container">
    <div id="map-viewport">
      <object
        id="metro-map"
        type="image/svg+xml"
        data="moya_moskva_base_map.svg">
      </object>
    </div>
  </main>

</div>

<!-- ========================= -->
<!-- FIREBASE (compat версия) -->
<!-- ========================= -->

<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-storage-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyC0x6YWKPKC7McI58rEgHxnS9OXSYPMuH4",
    authDomain: "moya-moskva.firebaseapp.com",
    projectId: "moya-moskva",
    storageBucket: "moya-moskva.appspot.com", // ← ИСПРАВЛЕНО
    messagingSenderId: "397269931085",
    appId: "1:397269931085:web:a5c54a888396794a25b804"
  };

  firebase.initializeApp(firebaseConfig);

  window.db = firebase.firestore();
  window.storage = firebase.storage();
</script>

<script src="app.js"></script>

</body>
</html>
